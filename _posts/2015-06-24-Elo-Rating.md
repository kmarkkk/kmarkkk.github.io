---
layout: post
title:  "Elo天梯积分系统"
description:
categories:
- Tech
tag: Tech
permalink: elo-ratings
---

今天打了两局DotA的天梯, 第一局赢了加了23, 第二局输了扣了25. 等于说白打一个小时还掉了2分...作者十分气愤为什么好不容易赢了加的分却不如随便一下输了的多, 于是Google了天梯积分系统. 虽然Valve具体怎么计算Rank分无从考究, 但了解到现在主流匹配系统算分的基本上是基于Elo Rating System. 其基本思想并不复杂也很有意思, 与其让他睡在我的evernote里, 不如放这分享一下...
<!--more-->	

##**Elo天梯积分**
Elo Rating System, 作者Arpad Elo. 具体可以自行Wiki. 这个系统中文名为等级分, 或者埃罗排名, 是由美国物理学家Elo发明的衡量博弈活动的方法. 最初是应用于国际象棋对弈, 以此为每位选手定分. 现在已经广泛应用于足球篮球围棋, lol和wow等竞技游戏里.

其思路简而言之乃假设每位玩家每一场的水平服是一个正态分布的随机变量, 虽然在不同的局里有可能发挥浮动很大, 但平均下来在一段时间内的变化很小并且比较稳定. Elo用这个平均值来衡量一位选手的等级分. Elo模型最早的时候采用正态分布, 但后期实践表明选手的表现并非呈现Normal Distribution, 反而更加趋于一个Logistic Distribution.


###**积分计算公式**
现在假设两名选手A, B被匹配到天梯比赛, 两人的Rank分数分别为$$R_a=4000$$和$$R_b=4100$$. 那么, 根据Logistic Distribution我们算出A, B两选手的期望胜负值$$E_a$$和$$E_b$$.

$$E_a = \frac{1}{1 + 10^{(R_b - R_a)/400}} \approx 0.36 $$ 

$$E_b = \frac{1}{1 + 10^{(R_a - R_b)/400}} \approx 0.64 $$

对于任意一位选手, 他的比赛结果S(胜利=1, 平=0.5, 负=0)将决定他的天梯分数的调整. 以选手A为例,

$$R_a' = R_a + K(S_a - E_a)$$

K 是一个tuning variable, 代表理论上最多可以赢一个玩家的得分和失分, K/2就是相同rating的玩家其中一方胜利后所得的分数. 国际象棋大师赛中, K=1. 在大部分的游戏规则中, K=32. 通常水平越高的比赛中其K值越小, 这样做是为了避免少数的几场比赛就能改变高端顶尖玩家的排名.

因为, 对于我们的例子, 假设K为32, 如果A赢了, 则

$$R_a' = 4000 + 32 * (1-0.36) = 4000 + 20 = 4020$$

反之, 如果B赢了, 则

$$R_b' = 4100 + 32 * (1 - 0.64) = 4100 + 12 = 4112 $$

因为B选手分比A高, 所以系统对他的胜利的期望值比较高, 因此如果B输给了A, A将会获得更多的奖励.
因此...作者只能认为自己打了一局好不容易赢了却立刻又输给了分更低的人, 所以积分不进反退.


##**数学公式**
可能有朋友会好奇这些数学公式是怎么打的. Markdown并没有很好的支持Latex的东西, 所以最粗糙的方法就是使用在线Latex, 转化图片, 下载, 再用Markdown将其include进来.

更好的一个方法是使用kramdown和MathJax的组合. 具体可以参考这篇[blog][bg]. 这样就和以和使用Latex一样用$$添加数学公式了.



[bg]: http://christopherpoole.github.io/using-mathjax-on-github-pages/